<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <title>{{ page.title }} | Signals & Patterns</title>
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <link rel="stylesheet" href="/assets/style.css" />
</head>

<body>
  <div class="section-progress" id="sectionProgress"></div>


  <!-- ARTICLE HERO -->
  <section class="hero-banner">
    <img
      src="{{ page.banner }}"
      alt="{{ page.title }}"
      class="hero-bg"
    />

    <div class="hero-overlay">
      <h1>{{ page.title }}</h1>
    </div>
  </section>

  <!-- ARTICLE CONTENT -->
  <article class="article">

    {% if page.tldr %}
      <section class="tldr">
        <strong>TL;DR</strong>
        <p>{{ page.tldr }}</p>
      </section>
    {% endif %}

    <section class="article-body">
      {{ content }}
    </section>

    <section class="article-footer">
      <a href="/blogs/" class="read-link">‚Üê Back to all articles</a>
    </section>

  </article>

<script>
(function () {
  const body = document.querySelector('.article-body');
  if (!body) return;

  let currentCard = null;
  const children = Array.from(body.children);

  children.forEach(node => {
    if (node.tagName === 'H2') {
      currentCard = document.createElement('section');
      currentCard.className = 'article-card';
      node.before(currentCard);
    }

    if (currentCard) {
      currentCard.appendChild(node);
    }
  });
})();
</script>


  <script>
const cards = document.querySelectorAll('.article-card');

const observer = new IntersectionObserver(
  entries => {
    entries.forEach(entry => {
      if (entry.isIntersecting) {
        entry.target.classList.add('is-visible');
      }
    });
  },
  { threshold: 0.15 }
);

cards.forEach(card => observer.observe(card));
</script>


<script>
(function () {
  const paragraphs = document.querySelectorAll('.article-body p');

  paragraphs.forEach(p => {
    const text = p.innerText.trim();

    // Heuristic: single strong sentence
    if (
      text.length > 90 &&
      text.length < 220 &&
      !text.includes('?') &&
      !p.querySelector('a')
    ) {
      p.classList.add('key-sentence');
    }
  });
})();
</script>

  
<script>
(function () {
  function initSectionProgress() {
    const sections = document.querySelectorAll('.article-card');
    const progress = document.getElementById('sectionProgress');

    if (!sections.length || !progress) return;

    // Clear in case of re-run
    progress.innerHTML = '';

    sections.forEach(() => {
      const dot = document.createElement('div');
      dot.className = 'section-progress-dot';
      progress.appendChild(dot);
    });

    const dots = progress.querySelectorAll('.section-progress-dot');

    const observer = new IntersectionObserver(
      entries => {
        entries.forEach(entry => {
          if (entry.isIntersecting) {
            const index = Array.from(sections).indexOf(entry.target);
            dots.forEach((dot, i) =>
              dot.classList.toggle('active', i <= index)
            );
          }
        });
      },
      { threshold: 0.35 }
    );

    sections.forEach(section => observer.observe(section));
  }

  // Run AFTER DOM + card wrapping
  window.addEventListener('load', initSectionProgress);
})();
</script>

  
</body>
</html>
